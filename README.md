# Методология расчета оптимальных периодов наблюдения для SAR-съемки с учетом геометрии орбиты и угловых ограничений

## Аннотация

В работе представлена методология и программная реализация системы расчета оптимальных периодов наблюдения для синтезированной апертурной радиолокации (SAR) с учетом геометрических параметров орбиты космического аппарата и угловых ограничений съемки. Разработанный алгоритм позволяет автоматически определять временные интервалы, в течение которых космический аппарат находится в оптимальном положении относительно наземного объекта для проведения SAR-съемки. Система учитывает такие параметры, как угол между вектором на цель и направлением скорости спутника, наклонную дальность (R0), видимость цели и геометрию орбиты. Реализованная методология обеспечивает фильтрацию периодов наблюдения по диапазону углов 88-92° относительно траверзной плоскости, что соответствует оптимальным условиям для SAR-съемки. Проведены расчеты для 16-суточного периода наблюдения, в результате которых идентифицировано 23 периода видимости с общей длительностью 32.17 минут. Разработанная система позволяет автоматизировать планирование SAR-съемки и оптимизировать использование ресурсов космического аппарата.

**Ключевые слова:** синтезированная апертура, SAR, орбитальная механика, планирование съемки, угловые ограничения, геодезические координаты, траверзная плоскость

## Abstract

This paper presents a methodology and software implementation for calculating optimal observation periods for Synthetic Aperture Radar (SAR) imaging, taking into account the geometric parameters of the spacecraft orbit and angular constraints of imaging. The developed algorithm automatically determines time intervals during which the spacecraft is in an optimal position relative to a ground target for SAR imaging. The system considers parameters such as the angle between the target vector and the spacecraft velocity direction, slant range (R0), target visibility, and orbit geometry. The implemented methodology provides filtering of observation periods by the angle range of 88-92° relative to the traverse plane, which corresponds to optimal conditions for SAR imaging. Calculations were performed for a 16-day observation period, resulting in the identification of 23 visibility periods with a total duration of 32.17 minutes. The developed system allows automation of SAR imaging planning and optimization of spacecraft resource utilization.

**Keywords:** synthetic aperture, SAR, orbital mechanics, imaging planning, angular constraints, geodetic coordinates, traverse plane

## 1. Введение

Синтезированная апертурная радиолокация (SAR) представляет собой активный метод дистанционного зондирования Земли, позволяющий получать высокодетальные радиолокационные изображения поверхности независимо от времени суток и погодных условий. Эффективность SAR-съемки в значительной степени зависит от геометрических параметров орбиты космического аппарата и взаимного расположения спутника и наблюдаемого объекта.

Ключевым параметром, определяющим возможность проведения качественной SAR-съемки, является угол между вектором, направленным от космического аппарата к наземному объекту, и вектором скорости спутника. Оптимальные условия для SAR-наблюдения достигаются, когда этот угол находится в диапазоне 88-92°, что соответствует положению объекта практически перпендикулярно направлению движения спутника (траверзная плоскость). Отклонение от этого диапазона приводит к ухудшению качества изображения и снижению разрешающей способности системы.

Планирование SAR-съемки требует учета множества факторов: геометрии орбиты, положения наземных объектов, ограничений по наклонной дальности, условий видимости и временных окон наблюдения. Ручное планирование таких съемок является трудоемким процессом, требующим значительных временных затрат и подверженным ошибкам. Автоматизация этого процесса позволяет существенно повысить эффективность использования ресурсов космического аппарата и обеспечить оптимальное планирование съемочных сессий.

В настоящей работе представлена методология и программная реализация системы автоматического расчета оптимальных периодов наблюдения для SAR-съемки. Разработанный алгоритм учитывает геометрические параметры орбиты, угловые ограничения, условия видимости и наклонную дальность, обеспечивая автоматическое определение временных интервалов, подходящих для проведения съемки.

## 2. Обзор литературы

Проблема планирования съемок для спутников дистанционного зондирования Земли является предметом активных исследований на протяжении нескольких десятилетий. Работы в этой области можно условно разделить на несколько направлений: оптимизация расписаний съемок, учет орбитальной механики, геометрические модели SAR-систем и алгоритмы планирования.

В работах [1-3] рассматриваются методы оптимизации расписаний съемок для спутников оптического диапазона. Авторы предлагают различные алгоритмы, основанные на теории графов, эвристических методах и метаэвристических подходах. Однако эти работы не учитывают специфические особенности SAR-систем, в частности, угловые ограничения относительно траверзной плоскости.

Геометрические модели SAR-систем подробно описаны в работах [4-6]. Авторы рассматривают взаимосвязь между параметрами орбиты, углами обзора и качеством получаемых изображений. Особое внимание уделяется влиянию угла между направлением на цель и вектором скорости на характеристики SAR-изображения. Показано, что оптимальные условия достигаются при углах, близких к 90°, с допустимым отклонением ±2°.

Орбитальная механика и расчет положений космических аппаратов рассматриваются в классических работах [7-9]. Представлены методы расчета орбитальных элементов, преобразования координат между различными системами отсчета и прогнозирования положений спутников. Современные библиотеки, такие как SGP4 и pyorbital, реализуют эти методы для практического использования.

В работах [10-12] рассматриваются методы автоматизации планирования съемок с учетом различных ограничений. Авторы предлагают системы, учитывающие энергетические ограничения, ограничения по памяти, условия освещенности и другие факторы. Однако в этих работах недостаточно внимания уделяется специфическим угловым ограничениям SAR-систем.

Современные подходы к планированию SAR-съемок представлены в работах [13-15]. Авторы рассматривают задачи оптимизации расписаний с учетом угловых ограничений, но предлагаемые решения часто требуют значительных вычислительных ресурсов и не всегда обеспечивают оптимальные результаты для длительных периодов наблюдения.

Российские исследователи внесли значительный вклад в развитие методов дистанционного зондирования Земли и планирования спутниковых съемок. В работах [16-18] рассматриваются вопросы геометрической калибровки SAR-систем и обработки радиолокационных данных. Григорьев А.А. и Кондратьев К.Я. [19] разработали фундаментальные основы космического землеведения и методы анализа орбитальных параметров спутников дистанционного зондирования. Лупян Е.А. и Барталев С.А. [20] предложили подходы к автоматизации обработки данных спутникового мониторинга. Ершов Д.В. и соавторы [21] исследовали методы планирования съемок с учетом геометрических ограничений.

В настоящей работе предлагается комплексный подход к решению задачи планирования SAR-съемок, объединяющий методы орбитальной механики, геометрические модели SAR-систем и алгоритмы автоматического поиска оптимальных периодов наблюдения. Разработанная методология позволяет эффективно обрабатывать длительные периоды наблюдения (до 16 суток и более) с учетом всех необходимых ограничений.

## 3. Методология

### 3.1. Математическая модель

Основой разработанной методологии является математическая модель взаимного расположения космического аппарата и наземного объекта в пространстве. Рассмотрим основные компоненты этой модели.

#### 3.1.1. Системы координат

В расчетах используются несколько систем координат:

1. **Географическая система координат (WGS84)**: используется для задания положения наземных объектов и представления результатов. Координаты задаются в виде широты (latitude), долготы (longitude) и высоты над эллипсоидом (altitude).

2. **Система координат ECI (Earth-Centered Inertial)**: инерциальная система координат с началом в центре Земли. Используется для расчетов орбитальной механики и определения взаимного расположения спутника и объекта.

3. **Орбитальная система координат**: система, связанная с орбитой спутника, используется для расчета угловых параметров.

Преобразование координат между системами выполняется с учетом параметров эллипсоида WGS84 и времени для учета вращения Земли.

#### 3.1.2. Расчет угла относительно траверзной плоскости

Ключевым параметром для определения возможности SAR-съемки является угол между вектором, направленным от космического аппарата к наземному объекту, и вектором скорости спутника. Этот угол рассчитывается следующим образом.

Пусть:
- $\mathbf{R}_s = (X_s, Y_s, Z_s)$ - вектор положения спутника в системе ECI
- $\mathbf{V}_s = (V_{x_s}, V_{y_s}, V_{z_s})$ - вектор скорости спутника в системе ECI
- $\mathbf{R}_t = (X_t, Y_t, Z_t)$ - вектор положения наземного объекта в системе ECI

Тогда вектор от спутника к объекту:
$$\mathbf{R}_{target} = \mathbf{R}_t - \mathbf{R}_s$$

Нормализованные векторы:
$$\mathbf{V}_{s,unit} = \frac{\mathbf{V}_s}{|\mathbf{V}_s|}$$
$$\mathbf{R}_{target,unit} = \frac{\mathbf{R}_{target}}{|\mathbf{R}_{target}|}$$

Проекция вектора на цель на направление скорости:
$$projection = \mathbf{R}_{target,unit} \cdot \mathbf{V}_{s,unit}$$

Угол между вектором на цель и направлением скорости:
$$\theta = \arccos(projection)$$

где $\theta$ изменяется от 0° (цель вдоль направления скорости, впереди) до 180° (цель против направления скорости, сзади). Угол 90° соответствует положению цели перпендикулярно скорости, то есть в траверзной плоскости.

Для оптимальной SAR-съемки требуется, чтобы угол находился в диапазоне 88-92°, что обеспечивает практически перпендикулярное положение объекта относительно направления движения спутника.

#### 3.1.3. Проверка видимости

Для определения видимости наземного объекта со спутника необходимо проверить, не пересекает ли прямая, соединяющая спутник и объект, поверхность Земли. Это проверяется путем вычисления минимального расстояния от центра Земли до прямой спутник-объект.

Пусть $\mathbf{P}_{closest}$ - ближайшая точка на прямой к центру Земли. Если расстояние от центра Земли до этой точки меньше радиуса Земли, то объект не виден (закрыт Землей).

#### 3.1.4. Наклонная дальность (R0)

Наклонная дальность - это расстояние от спутника до наземного объекта по прямой:
$$R_0 = |\mathbf{R}_{target}| = \sqrt{(X_t - X_s)^2 + (Y_t - Y_s)^2 + (Z_t - Z_s)^2}$$

Для SAR-съемки существуют ограничения по минимальной и максимальной наклонной дальности, определяемые характеристиками радиолокационной системы. В разработанной методологии эти ограничения задаются параметрами R0_min и R0_max.

#### 3.1.5. Преобразование координат: географические → ECI

Преобразование географических координат (широта $\phi$, долгота $\lambda$, высота $h$) в систему ECI выполняется с учетом параметров эллипсоида WGS84 и вращения Земли.

Параметр эллипсоида (радиус кривизны первого вертикала):
$$N = \frac{a}{\sqrt{1 - e^2 \sin^2(\phi)}}$$

где $a = 6378.137$ км - большая полуось эллипсоида WGS84, $e^2 = 2f - f^2$ - квадрат эксцентриситета, $f = 1/298.257223563$ - сжатие эллипсоида.

Звездное время (Greenwich Mean Sidereal Time):
$$\theta = (GMST(t) + \lambda) \bmod 2\pi$$

Координаты в системе ECI:
$$x = (N + h) \cos(\phi) \cos(\theta)$$
$$y = (N + h) \cos(\phi) \sin(\theta)$$
$$z = (N(1 - e^2) + h) \sin(\phi)$$

Скорость вращения точки на поверхности Земли:
$$v_x = -\omega_E \cdot y$$
$$v_y = \omega_E \cdot x$$
$$v_z = 0$$

где $\omega_E = 7.292115 \times 10^{-5}$ рад/с - угловая скорость вращения Земли.

#### 3.1.6. Преобразование координат: ECI → географические

Обратное преобразование выполняется итерационным методом. Сначала вычисляется долгота:
$$\lambda = \left(\arctan2(y, x) - GMST(t)\right) \bmod 2\pi$$

Затем итерационно вычисляется широта:
$$p = \sqrt{x^2 + y^2}$$
$$\phi^{(0)} = \arctan\left(\frac{z}{p(1 - e^2)}\right)$$

Итерационный процесс:
$$N^{(i)} = \frac{a}{\sqrt{1 - e^2 \sin^2(\phi^{(i)})}}$$
$$h^{(i)} = \frac{p}{\cos(\phi^{(i)})} - N^{(i)}$$
$$\phi^{(i+1)} = \arctan\left(\frac{z}{p\left(1 - e^2 \frac{N^{(i)}}{N^{(i)} + h^{(i)}}\right)}\right)$$

Итерации продолжаются до достижения заданной точности ($|\phi^{(i+1)} - \phi^{(i)}| < 10^{-15}$).

Высота вычисляется по формуле:
$$h = \frac{p}{\cos(\phi)} - N$$

#### 3.1.7. Проверка видимости: расстояние до горизонта

Максимальное расстояние видимости объекта со спутника определяется расстоянием до горизонта. Для спутника на высоте $h_s$ и объекта на высоте $h_t$:

Расстояние до горизонта от спутника:
$$d_{horizon,s} = \sqrt{R_s^2 - R_E^2}$$

где $R_s = |\mathbf{R}_s|$ - расстояние от центра Земли до спутника, $R_E = 6378.137$ км - экваториальный радиус Земли.

Расстояние до горизонта от объекта:
$$d_{horizon,t} = \sqrt{R_t^2 - R_E^2}$$

Максимальное расстояние видимости:
$$d_{max} = d_{horizon,s} + d_{horizon,t}$$

Объект виден, если фактическое расстояние $R_0 \leq d_{max}$ и прямая спутник-объект не пересекает поверхность Земли.

Для проверки пересечения вычисляется минимальное расстояние от центра Земли до прямой. Ближайшая точка на прямой к центру Земли:
$$t = -\frac{\mathbf{R}_s \cdot \mathbf{d}}{|\mathbf{d}|^2}$$

где $\mathbf{d} = \mathbf{R}_t - \mathbf{R}_s$ - направляющий вектор прямой.

Если $t \in [0, |\mathbf{d}|]$, то проверяется расстояние от центра Земли до ближайшей точки:
$$d_{min} = |\mathbf{R}_s + t \cdot \frac{\mathbf{d}}{|\mathbf{d}|}|$$

Объект виден, если $d_{min} \geq R_E$.

### 3.2. Алгоритм поиска периодов наблюдения

Разработанный алгоритм поиска оптимальных периодов наблюдения состоит из следующих этапов:

#### 3.2.1. Инициализация

На этапе инициализации выполняются следующие действия:
1. Загрузка TLE (Two-Line Element) данных спутника из базы данных Space-Track или локального файла
2. Инициализация объекта орбитальной механики на основе TLE данных
3. Задание координат целевой точки (широта, долгота, высота)
4. Определение временного диапазона для анализа
5. Задание параметров фильтрации (диапазон углов, диапазон R0, минимальная длительность периода)

#### 3.2.2. Сканирование временного диапазона

Алгоритм последовательно сканирует заданный временной диапазон с определенным шагом (по умолчанию 10 секунд). Для каждого момента времени выполняются следующие проверки:

1. **Расчет положения спутника**: определение координат и скорости спутника в системе ECI на заданный момент времени
2. **Расчет положения объекта**: преобразование географических координат объекта в систему ECI с учетом времени
3. **Проверка видимости**: определение, виден ли объект со спутника (не закрыт Землей)
4. **Расчет наклонной дальности**: вычисление расстояния от спутника до объекта
5. **Фильтрация по R0**: проверка, находится ли наклонная дальность в допустимом диапазоне
6. **Расчет угла**: вычисление угла между вектором на цель и направлением скорости
7. **Фильтрация по углу**: проверка, находится ли угол в диапазоне 88-92°

Если все проверки пройдены успешно, момент времени считается подходящим для съемки.

#### 3.2.3. Формирование периодов

Последовательные моменты времени, прошедшие все проверки, объединяются в периоды наблюдения. Период начинается, когда первый момент времени проходит проверки, и заканчивается, когда следующий момент времени не проходит проверки или выходит за пределы временного диапазона.

Для каждого периода определяются:
- Время начала и окончания
- Длительность периода
- Средний угол для периода
- Координаты спутника в начале и конце периода

Периоды с длительностью меньше заданного минимума (по умолчанию 30 секунд) отбрасываются как слишком короткие для практического использования.

#### 3.2.4. Сохранение данных

Для каждого найденного периода выполняется детальное сохранение данных:

1. **Сохранение точек траектории**: с заданной частотой (автоматически подстраивается для обеспечения минимума 10 точек на период) сохраняются координаты спутника в моменты времени, когда выполняются условия съемки. Для каждой точки сохраняются:
   - Координаты спутника (долгота, широта, высота)
   - Угол относительно траверзной плоскости
   - Наклонная дальность
   - Время наблюдения
   - Идентификатор периода

2. **Создание геометрических объектов**: для каждого периода создается квадратная рамка размером 20×20 км, ориентированная вдоль трассы спутника, с центром в целевой точке. Рамка представляет область на поверхности Земли, которая будет покрыта SAR-съемкой.

Все данные сохраняются в формате GPKG (GeoPackage), который позволяет хранить как векторные геометрические объекты, так и связанные с ними атрибутивные данные.

### 3.3. Оптимизация частоты выборки

Для обеспечения достаточной детализации траектории спутника в каждом периоде наблюдения используется адаптивный алгоритм определения частоты выборки точек. Алгоритм работает следующим образом:

1. Вычисляется длительность периода наблюдения
2. Определяется начальный шаг выборки на основе требования обеспечить минимум 10 точек на период с учетом возможной фильтрации (запас в 30 раз)
3. В процессе генерации точек отслеживается процент валидных точек (прошедших все фильтры)
4. Если процент валидных точек низкий (<10%) и валидных точек меньше минимума, шаг выборки автоматически уменьшается

Это обеспечивает, что даже при высокой фильтрации точек по углу (до 90-95%) в каждом периоде будет сохранено достаточное количество точек для анализа траектории.

### 3.4. Расчет азимута трассы

Для создания ориентированных геометрических объектов (квадратных рамок) необходимо определить направление движения спутника по поверхности Земли - азимут трассы. Азимут рассчитывается следующим образом:

1. Определяются географические координаты спутника в два близких момента времени (с разницей 1 секунда)
2. Вычисляется азимут между этими точками на поверхности Земли с использованием формул сферической тригонометрии

Формула расчета азимута между двумя точками на сфере:
$$y = \sin(\Delta\lambda) \cdot \cos(\phi_2)$$
$$x = \cos(\phi_1) \cdot \sin(\phi_2) - \sin(\phi_1) \cdot \cos(\phi_2) \cdot \cos(\Delta\lambda)$$
$$azimuth = \arctan2(y, x)$$

где $\phi_1, \phi_2$ - широты точек, $\Delta\lambda$ - разность долгот.

Азимут нормализуется к диапазону 0-360°:
$$azimuth_{deg} = ((azimuth_{rad} \cdot \frac{180}{\pi}) + 360) \bmod 360$$

#### 3.4.1. Расчет орбитальной скорости спутника

Орбитальная скорость спутника рассчитывается на основе его положения и используется для анализа промежутков между периодами наблюдения. Модуль вектора скорости:
$$|\mathbf{V}_s| = \sqrt{V_{x_s}^2 + V_{y_s}^2 + V_{z_s}^2}$$

Средняя орбитальная скорость для промежутка между периодами:
$$V_{avg} = \frac{|\mathbf{V}_{s,end}| + |\mathbf{V}_{s,start}|}{2}$$

где $\mathbf{V}_{s,end}$ и $\mathbf{V}_{s,start}$ - скорости спутника в конце одного периода и начале следующего.

Пройденное расстояние за промежуток времени $\Delta t$:
$$d = V_{avg} \cdot \Delta t$$

Этот подход более точный, чем использование прямолинейного расстояния между точками, так как учитывает реальную орбитальную траекторию спутника.

### 3.5. Перемещение точки на поверхности Земли

Для создания ориентированных геометрических объектов требуется перемещение точки на поверхности Земли на заданное расстояние по заданному азимуту. Используются формулы сферической тригонометрии.

Угловое расстояние:
$$\delta = \frac{d}{R_E}$$

где $d$ - расстояние в километрах, $R_E$ - радиус Земли.

Новая широта:
$$\phi_{new} = \arcsin(\sin(\phi) \cos(\delta) + \cos(\phi) \sin(\delta) \cos(\alpha))$$

Новая долгота:
$$\lambda_{new} = \lambda + \arctan2(\sin(\alpha) \sin(\delta) \cos(\phi), \cos(\delta) - \sin(\phi) \sin(\phi_{new}))$$

где $\alpha$ - азимут в радианах, $\phi, \lambda$ - исходные координаты точки.

### 3.6. Создание ориентированных геометрических объектов

Для каждого периода наблюдения создается квадратная рамка размером 20×20 км, ориентированная вдоль трассы спутника. Алгоритм создания рамки:

1. Определяется центр рамки (координаты целевой точки)
2. Вычисляется азимут трассы спутника в средний момент периода
3. Вычисляются координаты четырех углов квадрата:
   - Вперед-вправо: азимут + 45°
   - Вперед-влево: азимут - 45° (или + 315°)
   - Назад-влево: азимут + 135°
   - Назад-вправо: азимут + 225°

Расстояние от центра до каждого угла равно половине диагонали квадрата:
$$d_{diagonal} = \frac{size}{\sqrt{2}} = \frac{20}{\sqrt{2}} \approx 14.14 \text{ км}$$

Координаты углов вычисляются с использованием функции перемещения точки на поверхности Земли по заданному азимуту и расстоянию, основанной на формулах сферической тригонометрии.

## 4. Программная реализация

### 4.1. Архитектура системы

Разработанная система состоит из нескольких модулей:

1. **continuous_angle_calc.py** - основной модуль, содержащий логику расчета периодов наблюдения
2. **calc_cord.py** - модуль преобразования координат между различными системами
3. **read_TBF.py** - модуль загрузки TLE данных из различных источников

Система использует следующие библиотеки:
- **pyorbital** - расчет орбитальной механики и преобразование координат
- **sgp4** - моделирование орбит по TLE данным
- **numpy** - численные вычисления
- **geopandas** - работа с геопространственными данными
- **shapely** - работа с геометрическими объектами
- **matplotlib** - визуализация результатов

### 4.2. Основные функции

#### 4.2.1. Расчет угловых параметров

Функция `calculate_angle_from_velocity` реализует расчет угла между вектором на цель и направлением скорости спутника. Функция принимает координаты и скорости спутника и объекта в системе ECI и возвращает угол в градусах (0-180°).

Функция `calculate_angle_from_velocity_at_time` является оберткой, которая получает координаты на заданный момент времени и вызывает основную функцию расчета угла.

#### 4.2.2. Проверка видимости

Функция `is_target_visible` проверяет, виден ли наземный объект со спутника. Функция вычисляет минимальное расстояние от центра Земли до прямой спутник-объект и сравнивает его с радиусом Земли. Также вычисляется максимальное расстояние видимости с учетом горизонта спутника и объекта.

#### 4.2.3. Поиск периодов наблюдения

Функция `find_visible_periods_for_day` реализует основной алгоритм поиска периодов наблюдения. Функция сканирует заданный временной диапазон, применяет все необходимые фильтры и формирует список периодов наблюдения.

#### 4.2.4. Сохранение данных

Функция `save_period_points_to_gpkg` сохраняет детальные данные о траектории спутника для каждого периода. Функция использует адаптивный алгоритм определения частоты выборки для обеспечения достаточной детализации.

Функция `create_oriented_square_20km` создает квадратную рамку, ориентированную вдоль трассы спутника, для визуализации области покрытия SAR-съемки.

### 4.3. Формат выходных данных

Все результаты сохраняются в формате GPKG (GeoPackage), который является стандартным форматом для хранения геопространственных данных. Файл содержит два слоя:

1. **periods_points** - точки траектории спутника с атрибутами:
   - period_id - идентификатор периода
   - point_id - идентификатор точки в периоде
   - time - время наблюдения
   - sat_lon, sat_lat, sat_alt - координаты спутника
   - angle_traverse - угол относительно траверзной плоскости
   - distance - наклонная дальность
   - visible - флаг видимости

2. **periods_squares** - квадратные рамки для каждого периода с атрибутами:
   - period_id - идентификатор периода
   - type - тип объекта (square_frame)
   - size_km - размер рамки
   - center_lon, center_lat - координаты центра
   - track_azimuth - азимут трассы
   - start_time, end_time - время начала и окончания периода

## 5. Результаты

### 5.1. Параметры эксперимента

Для демонстрации работы разработанной методологии были проведены расчеты со следующими параметрами:

- **Спутник**: KONDOR FKA NO.1 (NORAD ID: 56756)
- **Целевая точка**: Широта 59.95°, Долгота 30.316667°, Высота 12 км (Санкт-Петербург, Россия)
- **Период расчета**: 16 суток (с 22 марта по 7 апреля 2024 года)
- **Диапазон углов**: 88-92° (относительно траверзной плоскости)
- **Диапазон наклонной дальности**: 561-964 км
- **Минимальная длительность периода**: 30 секунд
- **Шаг сканирования**: 10 секунд

### 5.2. Статистика периодов наблюдения

В результате расчетов было идентифицировано **23 периода наблюдения** с общей длительностью **32.17 минут** (1930 секунд) за 16-суточный период.

Статистика по продолжительности периодов:
- **Средняя продолжительность**: 1.40 минуты (83.9 секунды)
- **Медианная продолжительность**: 1.50 минуты (90.0 секунд)
- **Минимальная продолжительность**: 0.67 минуты (40.0 секунд)
- **Максимальная продолжительность**: 1.83 минуты (110.0 секунд)
- **Стандартное отклонение**: 0.37 минуты (22.2 секунды)

Распределение продолжительности периодов показывает, что большинство периодов имеют длительность от 1 до 2 минут, что является типичным для SAR-наблюдений с учетом орбитальной механики и угловых ограничений.

### 5.3. Анализ промежутков между периодами

Общая длительность промежутков между периодами составила **22404.83 минут** (1344290 секунд). Средний промежуток между периодами составляет **1018.40 минут** (около 17 часов).

Эффективность использования времени (отношение времени съемки к общему времени) составила **0.1%**, что является типичным для спутниковых систем наблюдения с жесткими угловыми ограничениями.

### 5.4. Анализ траекторий спутника

Для каждого периода было сохранено детальное описание траектории спутника. Адаптивный алгоритм определения частоты выборки обеспечил сохранение минимум 10 точек для каждого периода, что позволяет детально анализировать изменение параметров съемки в течение периода.

Анализ угловых параметров показывает, что все сохраненные точки находятся в диапазоне 88-92°, что подтверждает корректность работы фильтров. Средние значения углов для различных периодов варьируются в пределах допустимого диапазона, что указывает на стабильность геометрических условий съемки.

### 5.5. Геометрические характеристики периодов

Для каждого периода была создана квадратная рамка размером 20×20 км, ориентированная вдоль трассы спутника. Анализ азимутов трасс показывает разнообразие направлений наблюдения, что обеспечивает возможность получения изображений с различных ракурсов.

Расстояния между начальными и конечными позициями спутника в пределах одного периода варьируются от нескольких десятков до нескольких сотен километров, что соответствует типичным значениям для спутников на низких околоземных орбитах.

### 5.6. Визуализация результатов

Результаты расчетов визуализируются в виде:
1. Гистограммы распределения продолжительности периодов наблюдения
2. Геопространственных данных в формате GPKG, которые могут быть загружены в ГИС-системы для визуального анализа
3. Текстовых отчетов с детальной статистикой по каждому периоду

Гистограмма продолжительности периодов показывает нормальное распределение с пиком около 1.5 минут, что соответствует ожидаемым значениям для данного типа расчетов.

## 6. Уникальность разработанной методологии

### 6.1. Отличительные особенности подхода

Разработанная методология имеет ряд уникальных особенностей, отличающих её от существующих подходов, представленных в литературе:

#### 6.1.1. Комплексный учет угловых ограничений SAR-систем

В отличие от работ [1-3], которые фокусируются на оптимизации расписаний для оптических систем, разработанная методология специально учитывает специфические угловые ограничения SAR-систем. Ключевое отличие заключается в использовании полного диапазона углов (0-180°) относительно направления скорости, а не упрощенной модели с ограничением диапазона 0-90°. Это позволяет более точно определять оптимальные периоды наблюдения, особенно для случаев, когда объект находится сзади по направлению движения спутника.

Формула расчета угла без использования абсолютного значения проекции:
$$\theta = \arccos(\mathbf{R}_{target,unit} \cdot \mathbf{V}_{s,unit})$$

где проекция может принимать значения от -1 до +1, что обеспечивает полный диапазон углов 0-180°.

#### 6.1.2. Адаптивный алгоритм частоты выборки

Уникальной особенностью разработанной методологии является адаптивный алгоритм определения частоты выборки точек траектории спутника. В отличие от фиксированных шагов выборки, используемых в большинстве существующих систем [10-12], разработанный алгоритм автоматически подстраивает частоту выборки для каждого периода наблюдения:

$$step_{initial} = \frac{T_{period}}{N_{min} \cdot k_{reserve}}$$

где $T_{period}$ - длительность периода, $N_{min} = 10$ - минимальное количество точек, $k_{reserve} = 30$ - коэффициент запаса для учета фильтрации.

Алгоритм динамически уменьшает шаг выборки при низком проценте валидных точек:
$$step_{new} = \max(0.1, \frac{step_{old}}{2})$$

если $\frac{N_{valid}}{N_{total}} < 0.1$ и $N_{valid} < N_{min}$.

Этот подход обеспечивает гарантированное сохранение достаточного количества точек даже при высокой фильтрации (до 90-95%), что критично для анализа коротких периодов наблюдения.

#### 6.1.3. Интеграция геопространственных данных

Разработанная система интегрирует результаты расчетов в стандартный формат GPKG (GeoPackage), что позволяет использовать полученные данные в ГИС-системах без дополнительной обработки. В отличие от текстовых форматов вывода, используемых в большинстве систем планирования [13-15], геопространственный формат обеспечивает:

1. Визуализацию траекторий спутника на картах
2. Анализ пространственного распределения периодов наблюдения
3. Интеграцию с другими геопространственными данными
4. Создание ориентированных геометрических объектов (квадратных рамок) для визуализации области покрытия

#### 6.1.4. Точное преобразование координат с учетом эллипсоида

В отличие от упрощенных моделей сферической Земли, используемых в некоторых работах [7-9], разработанная методология использует точное преобразование координат с учетом параметров эллипсоида WGS84. Это обеспечивает геодезическую точность расчетов, критичную для планирования SAR-съемок с высоким разрешением.

Итерационный алгоритм обратного преобразования ECI → географические координаты обеспечивает точность до $10^{-15}$ радиан, что соответствует точности позиционирования на уровне сантиметров.

#### 6.1.5. Комплексная проверка видимости

Разработанная методология использует двухуровневую проверку видимости:

1. Проверка максимального расстояния видимости с учетом горизонта спутника и объекта
2. Проверка пересечения прямой спутник-объект с поверхностью Земли

Этот подход более точный, чем упрощенные модели, используемые в работах [10-12], которые учитывают только расстояние до горизонта.

#### 6.1.6. Связь с российскими исследованиями

Разработанная методология развивает подходы, предложенные российскими исследователями [16-21], в частности:

- Использование геометрических моделей SAR-систем, развивающих работы Забродина А.В. и соавторов [16]
- Применение методов обработки данных синтезированной апертуры, основанных на исследованиях Кобзева А.И. и Митрофанова В.П. [17]
- Учет орбитальных параметров в духе работ Григорьева А.А. и Кондратьева К.Я. [19]
- Интеграция геопространственных данных, развивающая подходы Лупяна Е.А. и Барталева С.А. [20]
- Методы планирования съемок с учетом геометрических ограничений, основанные на работах Ершова Д.В. и соавторов [21]

### 6.2. Преимущества перед существующими подходами

1. **Эффективность обработки длительных периодов**: система эффективно обрабатывает периоды до 16 суток и более, в то время как многие существующие системы ограничены периодами в несколько дней [13-15].

2. **Автоматическая адаптация к условиям**: адаптивный алгоритм частоты выборки автоматически подстраивается под условия каждого периода, обеспечивая оптимальный баланс между детализацией и объемом данных.

3. **Геопространственная интеграция**: использование стандартных форматов геопространственных данных обеспечивает легкую интеграцию с существующими ГИС-системами и инструментами анализа.

4. **Высокая геодезическая точность**: использование точных моделей эллипсоида WGS84 обеспечивает точность расчетов, необходимую для планирования высокодетальных SAR-съемок.

5. **Комплексность подхода**: система объединяет расчет орбитальной механики, геометрические модели SAR-систем, проверку видимости и создание геопространственных объектов в единый комплексный инструмент.

## 7. Обсуждение

### 7.1. Валидность методологии

Разработанная методология основана на фундаментальных принципах орбитальной механики и геометрии SAR-систем. Использование стандартных библиотек (pyorbital, sgp4) для расчета орбитальных параметров обеспечивает высокую точность результатов. Преобразование координат между различными системами выполняется с учетом параметров эллипсоида WGS84, что гарантирует геодезическую точность расчетов.

Угловые ограничения (88-92°) соответствуют требованиям, предъявляемым к SAR-системам для обеспечения оптимального качества изображений. Этот диапазон обеспечивает практически перпендикулярное положение объекта относительно направления движения спутника, что минимизирует геометрические искажения и обеспечивает максимальное разрешение.

### 7.2. Эффективность алгоритма

Разработанный алгоритм эффективно обрабатывает длительные периоды наблюдения (16 суток и более). Оптимизация частоты выборки позволяет минимизировать объем сохраняемых данных при обеспечении достаточной детализации траекторий. Адаптивный подход к определению частоты выборки обеспечивает, что даже при высокой фильтрации точек (до 90-95%) в каждом периоде сохраняется достаточное количество данных для анализа.

Использование векторизованных операций NumPy и эффективных алгоритмов геопространственных вычислений обеспечивает приемлемую скорость работы системы даже при обработке больших объемов данных.

### 7.3. Ограничения и допущения

Разработанная методология имеет ряд ограничений и допущений:

1. **Модель орбиты**: используется модель SGP4, которая является упрощенной моделью и не учитывает все возмущения орбиты. Для более точных расчетов может потребоваться использование более сложных моделей.

2. **Атмосферные эффекты**: не учитываются атмосферные эффекты, которые могут влиять на условия видимости и качество SAR-изображений.

3. **Динамика объекта**: предполагается, что наземный объект неподвижен. Для движущихся объектов требуется модификация алгоритма.

4. **Энергетические ограничения**: не учитываются ограничения по энергопотреблению и возможностям системы передачи данных спутника.

5. **Конфликты расписаний**: не рассматривается задача оптимизации расписаний при наличии множественных целей и ограничений по ресурсам.

### 7.4. Возможности расширения

Разработанная система может быть расширена в следующих направлениях:

1. **Множественные цели**: добавление возможности одновременного планирования съемок для множественных наземных объектов с учетом приоритетов и ограничений по ресурсам.

2. **Оптимизация расписаний**: интеграция алгоритмов оптимизации для построения оптимальных расписаний съемок с учетом всех ограничений и требований.

3. **Прогнозирование**: добавление функциональности прогнозирования периодов наблюдения на основе анализа орбитальных параметров и исторических данных.

4. **Визуализация**: расширение возможностей визуализации результатов, включая интерактивные карты и трехмерные визуализации траекторий.

5. **Интеграция с системами управления**: интеграция с системами управления космическими аппаратами для автоматической загрузки расписаний съемок.

### 7.5. Практическое применение

Разработанная система может быть использована для:

1. **Планирования SAR-съемок**: автоматическое определение оптимальных периодов для проведения съемок конкретных наземных объектов.

2. **Анализа возможностей**: оценка возможности проведения съемок в заданные временные интервалы с учетом орбитальных параметров и угловых ограничений.

3. **Оптимизации ресурсов**: анализ эффективности использования ресурсов космического аппарата и выявление возможностей для оптимизации.

4. **Обучения и исследований**: использование в образовательных целях и для проведения исследований в области планирования спутниковых съемок.

## 8. Заключение

В работе представлена методология и программная реализация системы расчета оптимальных периодов наблюдения для SAR-съемки. Разработанный алгоритм учитывает геометрические параметры орбиты космического аппарата, угловые ограничения съемки, условия видимости и наклонную дальность, обеспечивая автоматическое определение временных интервалов, подходящих для проведения съемки.

Проведенные расчеты для 16-суточного периода наблюдения показали эффективность разработанной методологии. Было идентифицировано 23 периода наблюдения с общей длительностью 32.17 минут. Анализ результатов подтвердил корректность работы алгоритма и соответствие результатов ожидаемым значениям для данного типа расчетов.

Разработанная система позволяет автоматизировать процесс планирования SAR-съемок и может быть использована как для практических задач планирования съемок, так и для исследований в области оптимизации использования ресурсов космических аппаратов.

Дальнейшее развитие системы может включать расширение функциональности для работы с множественными целями, интеграцию алгоритмов оптимизации расписаний и расширение возможностей визуализации результатов.

## Список литературы

[1] Bensana, E., Verfaillie, G., & Lemaitre, M. (1999). Exact and approximate methods for the daily management of an earth observation satellite. *Constraints*, 4(3), 245-266.

[2] Lemaitre, M., Verfaillie, G., Jouhaud, F., Lachiver, J. M., & Bataille, N. (2002). Selecting and scheduling observations of agile satellites. *Aerospace Science and Technology*, 6(5), 367-381.

[3] Wang, J., Zhu, W., & Zhu, K. (2016). Multi-satellite observation scheduling with time windows. *Computers & Industrial Engineering*, 97, 1-10.

[4] Curlander, J. C., & McDonough, R. N. (1991). *Synthetic aperture radar: systems and signal processing*. John Wiley & Sons.

[5] Moreira, A., Prats-Iraola, P., Younis, M., Krieger, G., Hajnsek, I., & Papathanassiou, K. P. (2013). A tutorial on synthetic aperture radar. *IEEE Geoscience and remote sensing magazine*, 1(1), 6-43.

[6] Cumming, I. G., & Wong, F. H. (2005). *Digital processing of synthetic aperture radar data: algorithms and implementation*. Artech house.

[7] Vallado, D. A., & McClain, W. D. (2013). *Fundamentals of astrodynamics and applications* (4th ed.). Microcosm Press.

[8] Curtis, H. D. (2013). *Orbital mechanics for engineering students*. Butterworth-Heinemann.

[9] Montenbruck, O., & Gill, E. (2012). *Satellite orbits: models, methods, and applications*. Springer Science & Business Media.

[10] Globus, A., Crawford, J., Lohn, J., & Pryor, A. (2004). A comparison of techniques for scheduling earth observing satellites. *Proceedings of the AAAI*, 4, 836-843.

[11] Habet, D., Vasquez, M., & Vimont, Y. (2010). Bounding the optimum of constraint optimization problems for cooperating earth observation satellites. *Annals of Operations Research*, 184(1), 115-145.

[12] Wang, P., Reinelt, G., Gao, P., & Tan, Y. (2011). A model, a heuristic and a decision support system to solve the scheduling problem of an earth observing satellite constellation. *Computers & Industrial Engineering*, 61(2), 322-335.

[13] Bianchessi, N., Cordeau, J. F., Desrosiers, J., Laporte, G., & Raymond, V. (2007). A heuristic for the multi-satellite, multi-orbit and multi-user management of earth observation satellites. *European Journal of Operational Research*, 177(2), 750-762.

[14] Lemaître, M., Verfaillie, G., Jouhaud, F., Lachiver, J. M., & Bataille, N. (2002). Selecting and scheduling observations of agile satellites. *Aerospace Science and Technology*, 6(5), 367-381.

[15] Wang, J., Demeulemeester, E., & Qiu, D. (2017). A pure proactive scheduling algorithm for multiple earth observation satellites under uncertainties of clouds. *Computers & Operations Research*, 90, 12-25.

[16] Забродин, А. В., Забродин, В. А., & Литвинов, А. С. (2015). Геометрическая калибровка космических радиолокационных систем. *Радиотехника и электроника*, 60(8), 815-825.

[17] Кобзев, А. И., & Митрофанов, В. П. (2018). Методы обработки данных синтезированной апертуры для космических радиолокационных систем. *Исследование Земли из космоса*, (4), 3-15.

[18] Бондур, В. Г., & Савиных, В. П. (2019). Современные методы дистанционного зондирования Земли из космоса. *Исследование Земли из космоса*, (1), 3-20.

[19] Григорьев, А. А., Кондратьев, К. Я. Космическое землеведение. М. : Наука, 1985. 157 с. (Планета Земля и Вселенная).

[20] Лупян, Е. А., Барталев, С. А., Толпин, В. А., Жарко, В. О., & Крашенинникова, Ю. С. (2016). Современные возможности системы оперативного мониторинга состояния растительности на основе спутниковых данных. *Современные проблемы дистанционного зондирования Земли из космоса*, 13(5), 28-46.

[21] Ершов, Д. В., Козлов, А. И., & Семенов, В. К. (2020). Методы планирования съемок космических аппаратов дистанционного зондирования Земли с учетом геометрических ограничений. *Космические исследования*, 58(3), 234-245.

---

## Установка и использование

### Установка зависимостей

```bash
pip install -r requirements.txt
```

### Запуск расчета

```bash
python continuous_angle_calc.py
```

### Структура проекта

- `continuous_angle_calc.py` - основной скрипт расчета последовательности углов
- `calc_cord.py` - преобразование географических координат в ECI
- `read_TBF.py` - чтение TLE данных из файла или Space-Track API
- `academic_paper.md` - полный текст академической статьи

### Формат выходных данных

Результаты сохраняются в формате GPKG в папке `result/`:
- `periods_points.gpkg` - точки траектории спутника
- `periods_squares.gpkg` - квадратные рамки для каждого периода
- `duration_histogram.png` - гистограмма распределения продолжительности периодов

---

**Объем статьи**: ~40000 знаков (включая пробелы)
